<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>L17: Concetti generali di Async</title>
  </head>
  <body>
    <h2>
      <ol>
        <li>Concetti generali Async</li>
        <li>Introduzione pratica Asincrono</li>
      </ol>
    </h2>
    <button id="date">Vai</button>
    <button id="alert">Alert</button>

    <button>Vai2</button>

    <script>
      // 1. Introduzione all'asincrono
      // generalmente codice letto dall'alto verso il basso

      // 2. Blocking code: concetto di thread (processo)
      // va avanti e ogni task blocca l'esecuzione del codice finché non è finito il task
      // ogni task occupa un singolo processo (thread)
      const btn = document.querySelector('#date');
      const btnAlert = document.querySelector('#alert');

      // btn è lento, genera del delay
      // non viene eseguito immediatamente
      // perché la sua funzione è lenta, pesante, quindi BLOCCA la lettura del codice che c'è dopo
      // relativo alla stampa della data
      // o in aggiunta anche dell'alert se subito dopo clicco su btnAlert
      // anche se btnAlert è già pronto
      btn.addEventListener('click', () => {
        let myDate;
        for (let i = 0; i < 10000000; i++) {
          let date = new Date(); // qui sto semplicemente calcolando la data di oggi
          myDate = date;
        }

        console.log(myDate);

        let pElem = document.createElement('p');
        pElem.textContent = 'This is a newly-added paragraph.';
        document.body.appendChild(pElem);
      });

      // btnAlert parte subito
      btnAlert.addEventListener('click', () => {
        alert('Eccomi');
      });

      // 3. Threads, js single threat - main thread, worker threads
      // JS è un programma single thread
      // è stato però reso multi-thread, è stato evoluto
      // multi-thread: main-thread (quello su cui sto lavorando, in cui ci sono btn e btnAlert) e worker thread
      // worker thread: canali di lavoro differenti che fanno eseguire in bg delle f
      // in questo modo il main-thread può continuare ad andare avanti

      // così un sito/app che deve scaricare i dati in bg, già è funzionante
      // (non sono obbligato ad attendere)
      // o il sito usa un applicazione, o il concesso di multi-thread, con i working threads che fanno il lavoro sporco scaricando i dati separatamente

      // 4. Codice asincrono
      // JS legge dall'alto verso il basso
      // con l'asincrono possiamo saltare parti agganciando situazioni
    </script>
  </body>
</html>
